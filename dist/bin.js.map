{"version":3,"sources":["../src/bin.js"],"names":["argv","process","slice","default","disableHttpInterface","httpPort","ipcServerId","core","Core","on","debug","ipc","config","id","ipcLogListener","dbSetup","then","ipcListenersThatPropogateToDb","options","httpSetup","spinUpSubProcesses","catch","shutdownWithError","err"],"mappings":";AACA;;AACA;;;;AACA;;;;;;AAGA,IAAIA,OAAO,wBAASC,QAAQD,IAAR,CAAaE,KAAb,CAAmB,CAAnB,CAAT,EAAgC;AACvCC,aAAS;AACLC,8BAAsB,KADjB;AAELC,kBAAU,IAFL;AAGLC,qBAAa,MAHR,CAGgB;AAHhB;AAD8B,CAAhC,CAAX;;AAQA,IAAMC,OAAO,IAAIC,eAAJ,CAASR,IAAT,CAAb;AACA;AACAO,KAAKE,EAAL,CAAQ,kBAAR,EAA4B,YAAM;AAC9BC,UAAM,qCAAqCH,KAAKI,GAAL,CAASC,MAAT,CAAgBC,EAA3D;AACA;AACAN,SAAKO,cAAL;AACA;AACAP,SAAKQ,OAAL,GAAeC,IAAf,CAAoB,YAAM;AACtBT,aAAKU,6BAAL;AACA;AACA,YAAK,CAACV,KAAKW,OAAL,CAAad,oBAAnB,EAA0C;AACtCG,iBAAKY,SAAL;AACH;AACD;AACAZ,aAAKa,kBAAL;AACH,KARD,EAQGC,KARH,CAQS,eAAO;AACZd,aAAKe,iBAAL,CAAuBC,GAAvB;AACH,KAVD;AAWH,CAhBD;AAiBAhB,KAAKE,EAAL,CAAQ,kBAAR,EAA4B,UAACc,GAAD,EAAS;AACjChB,SAAKe,iBAAL,CAAuBC,GAAvB;AACH,CAFD","file":"bin.js","sourcesContent":["\n'use strict';\nimport Core, { AO_CONSTANTS } from './index';\nimport minimist from 'minimist';\n\n\nvar argv = minimist(process.argv.slice(2), {\n    default: {\n        disableHttpInterface: false,\n        httpPort: 3000,\n        ipcServerId: 'test', // AO_CONSTANTS.IPC_SERVER_ID,\n    }\n});\n\nconst core = new Core(argv);\n// 1. IPC server\ncore.on('ipc:server:start', () => {\n    debug('ipc server started. server id = ' + core.ipc.config.id)\n    // 2. IPC log listener\n    core.ipcLogListener()\n    // 3. DB Setup\n    core.dbSetup().then(() => {\n        core.ipcListenersThatPropogateToDb()\n        // 4. HTTP server\n        if ( !core.options.disableHttpInterface ) {\n            core.httpSetup()\n        }\n        // 5. Sub-processes\n        core.spinUpSubProcesses()\n    }).catch(err => {\n        core.shutdownWithError(err)\n    })\n})\ncore.on('ipc:server:error', (err) => {\n    core.shutdownWithError(err)\n})"]}